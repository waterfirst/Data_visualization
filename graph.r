library(sciplot)
library(tidyverse)
data(ToothGrowth)
# One way design
bargraph.CI(x.factor = dose, response = len, data = ToothGrowth)
# Two-way design with options
bargraph.CI(dose, len, group = supp, data = ToothGrowth,
            xlab = "Dose", ylab = "Growth", cex.lab = 1.5, x.leg = 1,
            col = "black", angle = 45, cex.names = 1.25,
            density = c(0,20), legend = TRUE)

# One way design
lineplot.CI(x.factor = dose, response = len, data = ToothGrowth)
# Two-way design with options
lineplot.CI(dose, len, group = supp, data = ToothGrowth, cex = 2,
            xlab = "Dose", ylab = "Growth", cex.lab = 1.5, x.leg = 1,
            col = c("blue","red"), pch = c(16,16))


df <- tibble::tribble(
     ~CELL_ID,  ~dry, ~cmp, ~CMP후_ashing, ~LCF_35, ~FMP_30, ~FMP_48,
  "C02_22_1차", 3300L,  60L,         200L,          9,        5.4,        2.3,
  "B02_22_1차", 3300L,  60L,         200L,        7.6,        4.2,        1.6,
  "C05_22_1차", 3300L,  60L,         200L,        6.2,       10.6,        2.8,
  "B04_23_1차", 3300L,  45L,         200L,       10.6,        4.4,        2.1,
  "C05_21_2차", 3000L,  35L,         200L,        2.6,        1.9,        0.6,
  "C01_23_2차", 3000L,  20L,         200L,        2.7,        4.7,        1.8
  )

head(df)

df %>% pivot_longer(cols = LCF_35:FMP_48, names_to = "type", values_to = "cutoff") %>% 
  mutate(dry = as.factor(dry)) %>% 
  ggplot(aes(x=cmp, y=cutoff, col=type, shape=dry))+geom_point(size=3)+
  scale_fill_Publication() +theme_Publication()+
  labs(x="CMP 시간(분)", y="L/L0(%)")+
  theme(legend.position="top", legend.box = "vertical")
  guides(color = guide_legend(order=1),
         shape = guide_legend(order=3))



  
df %>% pivot_longer(cols = LCF_35:FMP_48, names_to = "type", values_to = "cutoff") %>% 
    mutate(dry = as.factor(dry)) %>% 
    ggplot(aes(x=cmp, y=cutoff, col=type, shape = dry))+geom_point(size=3)+
    scale_fill_Publication() +theme_Publication()+
    labs(x="CMP 시간(분)", y="L/L0(%)")+
    facet_wrap(~type)+
  geom_smooth(method = "gam")+
  scale_y_continuous(breaks = seq(0, 20, by = 5))+
    #geom_hdr(probs=c(0.99,0.5), alpha=0.5)

  theme(legend.position="top", legend.box = "vertical")
  guides(color = guide_legend(order=1),
         shape = guide_legend(order=3))
  
  ocl <- tibble::tribble(
    ~angle, ~OCL_22_C02_LCF, ~OCL_22_B02_LCF, ~OCL_22_C05_LCF, ~OCL_23_B04_LCF, ~OCL_22_C02_FMP, ~OCL_22_B02_FMP, ~OCL_22_C05_FMP, ~OCL_22_B04_FMP,
    0L,             100,             100,             100,             100,             100,             100,             100,             100,
    1L,     99.41722329,     101.4097527,     98.98039541,      101.684293,     99.71149715,     98.97669763,     99.22043656,     99.39031029,
    2L,     98.25166988,     100.1656267,     97.77013305,     98.90325108,     98.50837886,     97.72537679,     97.88918206,     97.68100163,
    3L,     96.46299368,     97.60804252,     95.29572678,     97.92401097,      97.1088331,     94.71108392,     95.65843128,     95.26401742,
    4L,      93.6298023,     96.84153763,     92.35296556,     96.14571093,     94.17469769,     91.42428119,     92.30031183,     91.08328797,
    5L,      90.8459228,     94.77698174,     90.06507233,     94.17547983,     89.62617396,     86.05750514,      87.5569681,     85.48176375,
    6L,     88.13825257,      91.9844388,     87.14717951,     90.83039561,     83.32207968,     78.32712307,     82.22595347,     78.05661404,
    7L,     85.06746761,     89.95454896,     83.80652381,     88.17077948,     76.64354552,     69.60680719,      76.5171504,      69.6624932,
    8L,     82.62877124,     85.56351591,     80.71040743,     84.39482961,     68.45497514,     60.99215839,     70.40657232,     60.16330974,
    9L,     80.17214327,     81.82343425,     77.60185684,     81.69604387,     60.00245534,     53.06712641,     63.78028304,     50.88731628,
    10L,     77.44654144,     77.68276712,     74.16172753,     79.05209557,     51.93665214,     45.64818419,     57.66970497,     43.10288514,
    11L,     74.51472632,     73.91572298,      69.9796908,     76.25930278,     45.25811798,     39.49168567,      52.3626769,      36.8535656,
    12L,     71.16151881,     69.81742547,     65.91785137,     72.96122209,     40.00982137,     34.19720816,     47.73926601,     32.01959717,
    13L,     67.45416237,     65.60357445,       62.166867,     69.60047004,     36.01374992,     30.12624437,     44.36915327,     28.30702232,
    14L,     64.42820639,     61.42053771,     59.07489535,     66.40814728,     32.76041986,     27.00628441,     41.41280883,     25.49809472,
    15L,     61.97606133,      57.5764579,     56.41397604,     63.54876616,     30.11478731,     24.45915133,      38.6603502,     23.20631464,
    16L,     60.17841933,     54.04052076,     53.92713557,     61.47277712,     28.02160702,     22.25682665,      36.1117774,     21.23026674,
    17L,     58.12525216,     51.40590093,     51.38641356,     59.57696827,     25.91615002,     20.17129192,     34.19884864,     19.37397931,
    18L,     55.59241494,      48.8637239,     48.99904671,     57.57540149,     23.68178749,     18.14693287,     32.48980571,      17.5557975,
    19L,     53.36441476,     46.31769509,     46.60339039,     54.92361927,     21.45356332,     16.26160948,     30.48093068,     15.75394665,
    20L,     50.93020128,     43.96040367,     44.02536577,     52.29925578,     19.09643361,     14.42633891,      28.5080355,     13.98475776,
    21L,     48.42874434,     41.55303906,     40.75931529,     49.16960439,     16.61039838,     12.59106835,     26.36123771,     12.39520958,
    22L,      45.7300399,     38.39072491,      37.0912256,     46.69800235,      14.3085139,     10.96713197,     24.21443991,     10.83832335,
    23L,     42.73098131,     34.74693783,     32.78899159,     44.00705053,     12.42403781,     9.565652633,     22.06164548,     9.324986391,
    24L,      39.5615726,     30.90285802,     28.59037593,     41.01840971,     10.77281935,     8.381068906,     19.99280403,     8.029395754,
    25L,     36.17250191,     27.02796395,     24.56998384,     37.61457109,     9.256644773,     7.352205105,      18.0978652,     7.060424605,
    26L,     32.41583359,     23.41884292,     20.88531521,     33.99529965,     8.090356639,     6.501306935,     16.21491964,     6.303756124,
    27L,     28.64571659,     20.11401279,     17.59025159,     30.34469252,     7.224848076,     5.817251543,     14.42192372,     5.699510071,
    28L,     24.92042857,     17.22902704,     14.81742446,     26.89776733,     6.512798478,      5.24442467,     12.93475654,     5.187806206,
    29L,     21.32066168,     14.74847855,     12.54611017,     23.52134743,     5.905100976,     4.727212057,     11.69345167,      4.73598258,
    30L,      18.0884924,     12.74169941,     10.72242716,       20.395613,     5.426309005,     4.248929426,     10.63204605,     4.360370169,
    31L,     15.37633927,     11.16632001,     9.313217557,     17.58715237,     5.045730772,     3.848506757,     9.600623651,      4.03375068,
    32L,     13.18420227,     9.902935059,     8.243876155,     15.20172346,     4.708121048,     3.525944052,     8.653154234,     3.761567774,
    33L,     11.48518402,     8.901471381,     7.394205662,     13.32941637,     4.382788042,     3.247872755,     7.867594147,      3.53837779,
    34L,     10.10893442,     8.165780756,     6.731048203,     11.81746964,     4.094285188,     3.014292865,     7.171983689,     3.364180729,
    35L,     9.015107365,     7.595716817,     6.217101173,     10.61887975,     3.848750844,     2.808520105,     6.590309427,     3.211758302,
    36L,     8.217151567,     7.172020646,     5.806772496,     9.706227967,     3.627769934,     2.624993048,     6.056608299,     3.075666848,
    37L,     7.629891962,     6.852322625,     5.487627969,     8.989424207,     3.437480818,     2.469273122,     5.588870233,     2.945019053,
    38L,     7.212982472,     6.617363839,     5.255522858,     8.444966706,     3.284021853,     2.335798899,     5.175101943,     2.819814916,
    39L,     6.926077016,     6.463292504,     5.085588759,     8.068938504,     3.136701246,     2.207886102,     4.785320221,     2.705498095,
    40L,     6.701932129,     6.351590787,      4.96539147,     7.798668233,     2.995518998,     2.107780435,     4.443511633,     2.612955906,
    41L,     6.545030708,     6.297665819,      4.89493099,     7.594986291,     2.860475109,     2.024359046,     4.149676181,     2.525857376,
    42L,     6.419509571,     6.239889069,     4.836904713,     7.403055229,     2.731569578,     1.946499082,     3.873830655,     2.444202504,
    43L,     6.307437127,     6.182112318,     4.783023169,     7.226792009,     2.602664048,     1.874200545,     3.627968338,      2.36799129,
    44L,     6.204330479,     6.116632001,     4.720852157,     7.081864473,      2.50445031,     1.818586286,     3.406092588,     2.297223734,
    45L,     6.114672524,       6.0472999,     4.650391677,     6.956521739,      2.41851329,       1.7574106,     3.226193332,     2.237343495,
    46L,     6.033980365,     5.962560666,     4.575786463,     6.842929886,     2.357129704,     1.696234915,     3.070280643,     2.188350572,
    47L,     5.953288205,     5.885524998,     4.501181249,     6.733254994,     2.301884476,     1.646182081,      2.93235788,     2.150244965,
    48L,     5.872596046,     5.820044681,     4.426576035,      6.60791226,     2.252777607,     1.601690673,     2.812425042,     2.117583016,
    49L,     5.787420989,     5.758416147,     4.351970821,     6.498237368,     2.203670738,     1.562760692,     2.704485488,     2.084921067,
    50L,     5.715694625,     5.685232263,     4.285655075,     6.396396396,     2.160702228,     1.529392136,     2.608539218,     2.052259118
  )
  

ocl %>% pivot_longer(-1, names_to = "cell_id", values_to = "cutoff") %>% 
  mutate(type = ifelse(str_detect(cell_id, "LCF"), "LCF", "FMP")) %>% 
    ggplot(aes(angle, cutoff, col=cell_id))+geom_point()+geom_line()+
  facet_wrap(~type,)+
  theme_clean()+
      theme_Publication()
  
           
